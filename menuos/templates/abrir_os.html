{% extends "base.html" %}
{% load static %}
{% block body %}

<div
  class="min-h-screen bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center px-6 py-12">
  <div
    class="w-full max-w-4xl bg-slate-800 shadow-2xl rounded-2xl overflow-hidden grid grid-cols-1 md:grid-cols-2">

    <!-- Lado esquerdo com logo e título -->
    <div class="bg-slate-900 p-8 text-center flex flex-col justify-center">
      <img class="mx-auto h-30 w-auto mb-4 rounded-full"
        src="{% static 'Logo_IMA.png' %}" alt="Logo_IMA" />
      <h2 class="text-3xl font-bold text-white">Abrir Nova Ordem de Serviço</h2>
      <p class="mt-2 text-sm text-gray-400">
        Precisa de ajuda?
        <a href="#" class="text-indigo-300 hover:underline">Fale com o
          suporte</a>.
      </p>
    </div>

    <!-- Formulário -->
    <form method="POST" class="p-8 space-y-6 bg-slate-800">
      {% csrf_token %}

      <div>
        <label class="block text-sm font-medium text-gray-200">Número da
          OS</label>
        <input
          type="text"
          name="numero_os"
          value="{{ numero_os }}"
          readonly
          class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white outline-none border border-white/10 focus:ring-2 focus:ring-indigo-500 sm:text-sm" />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-200">Descrição da
          OS</label>
        <textarea
          name="descricao"
          required
          rows="4"
          placeholder="Descreva o problema ou a solicitação."
          class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white border border-white/10 focus:ring-2 focus:ring-indigo-500 sm:text-sm">{{ form.descricao.value|default:'' }}</textarea>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-200">Centro de
          Custos</label>
        <select
          name="cc"
          id="centro_de_custo"
          required
          class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white border border-white/10 focus:ring-2 focus:ring-indigo-500 sm:text-sm">
          <option class="bg-slate-900 text-white" value>Selecione um Centro de
            Custo</option>
          {% for centro in centros %}
          <option
            class="bg-slate-900 text-white"
            value="{{ centro.codigo_custo }}"
            {% if form.cc.value == centro.codigo_custo %}selected{% endif %}>
            {{ centro.codigo_custo }} - {{ centro.descricao_custo }}
          </option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-200">Código do
          Cliente</label>
        <select
          name="cod_cliente"
          id="codigo_cliente"
          required
          class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white border border-white/10 focus:ring-2 focus:ring-indigo-500 sm:text-sm">
          <option class="bg-slate-900 text-white" value>Selecione</option>
          {% for cliente in clientes %}
          <option
            class="bg-slate-900 text-white"
            value="{{ cliente.pk }}"
            {% if form.cod_cliente.value == cliente.pk %}selected{% endif %}
            data-nome="{{ cliente.nome_cliente }}">
            {{ cliente.codigo_cliente }} - {{ cliente.nome_cliente }}
          </option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-200">Código Motivo da
          Intervenção</label>
        <select
          name="cod_intervencao"
          id="codigo_intervencao"
          required
          class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white border border-white/10 focus:ring-2 focus:ring-indigo-500 sm:text-sm">
          <option class="bg-slate-900 text-white" value>Selecione</option>
          {% for motivo in motivos %}
          <option
            class="bg-slate-900 text-white"
            value="{{ motivo.pk }}"
            {% if form.cod_intervencao.value == motivo.pk %}selected{% endif %}
            data-descricao="{{ motivo.descricao_motivo }}">
            {{ motivo.codigo_intervencao }} - {{ motivo.descricao_motivo }}
          </option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-200">SSM</label>
        <input
          type="number"
          name="ssm"
          placeholder="Digite o número do SSM"
          value="{{ form.ssm.value|default:'' }}"
          class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white border border-white/10 placeholder:text-gray-500 focus:ring-2 focus:ring-indigo-500 sm:text-sm" />
      </div>

     <div>
  <label class="block text-sm font-medium text-gray-200">Situação do Equipamento</label>
  <select
    name="prioridade"
    id="prioridade"
    required
    class="mt-1 block w-full rounded-md bg-white/5 px-3 py-2 text-white border border-white/10 focus:ring-2 focus:ring-indigo-500 sm:text-sm">
    
    <option class="bg-slate-900 text-white" value>Selecione</option>

    <option class="bg-slate-900 text-white" value="MaquinaParada" {% if form.prioridade.value == "MaquinaParada" %}selected{% endif %}>
      Máquina Parada
    </option>
    <option class="bg-slate-900 text-white" value="OperandoDefeito" {% if form.prioridade.value == "OperandoDefeito" %}selected{% endif %}>
      Operando Com Defeito
    </option>
    <option class="bg-slate-900 text-white" value="OperandoProgramada" {% if form.prioridade.value == "OperandoProgramada" %}selected{% endif %}>
      Operando Programada
    </option>
    <option class="bg-slate-900 text-white" value="OperandoParadaMelhoria" {% if form.prioridade.value == "OperandoParadaMelhoria" %}selected{% endif %}>
      Máquina Parada Melhoria
    </option>
    <option class="bg-slate-900 text-white" value="OperandoMelhoria" {% if form.prioridade.value == "OperandoMelhoria" %}selected{% endif %}>
      Operando Melhoria
    </option>
    <option class="bg-slate-900 text-white" value="Outros" {% if form.prioridade.value == "Outros" %}selected{% endif %}>
      Outros
    </option>
  </select>
</div>


      <div>
        <button
          type="submit"
          class="w-full rounded-md bg-indigo-600 py-2 text-white font-semibold hover:bg-indigo-500 transition">
          Abrir Ordem de Serviço
        </button>
      </div>

    </form>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const selectCliente = document.getElementById("codigo_cliente");
    const selectMotivo = document.getElementById("codigo_intervencao");

    selectCliente.addEventListener("change", function () {
      const nomeCliente = this.options[this.selectedIndex].getAttribute("data-nome");
    });

    selectMotivo.addEventListener("change", function () {
      const descricaoMotivo = this.options[this.selectedIndex].getAttribute("data-descricao");
    });
  });
</script>

{% endblock %}
