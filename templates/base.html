<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor OS</title>
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    {% block head %}{% endblock head %}
</head>
<body>
    {% block body %} {% endblock body %}
    
<script>
    // Redirecionamento ao Menu Principal ao clicar no botão Voltar do navegador
    document.addEventListener('DOMContentLoaded', function() {
    window.history.pushState(null, '', window.location.href);
    window.onpopstate = function(event) {
    window.location.href = "{% url 'menuos' %}";
    };
});
// Variável para controlar se o usuário está navegando internamente
  let navegandoInternamente = false;

  // Marca que o usuário clicou em algum link interno
  document.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      navegandoInternamente = true;
    });
  });

  // No evento beforeunload (fechar aba, recarregar, sair da página)
  window.addEventListener('beforeunload', function (event) {
    if (!navegandoInternamente) {
      // Se NÃO navegou internamente, faz o logout via sendBeacon
      navigator.sendBeacon("{% url 'logout' %}");
    }
    // Se navegou internamente, não faz logout
  });
</script>

</body>
</html>
